<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>How it works | Rust Search Extension - The ultimate search extension for Rust </title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="theme-color" content="#F9BB2D">
    <meta name="description"
          content="Rust Search Extension is a handy browser plugin to help you search Rust docs, crates, builtin attributes, books and error codes, etc instantly.">
    <meta name="keywords"
          content="rust, rust-lang, chrome extension, firefox extension, docs, rust docs, crates, rust attributes, rust books, rust error codes, search">
    <link href="https://fonts.googleapis.com/css?family=Alfa+Slab+One&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Fira+Sans:400,500,600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="&#x2F;index.css">
</head>
<body>

<header class="box-shadow">
    

<a href="&#x2F;">
    <div class="logo">
        <img src="&#x2F;logo.png" alt="rust-search-extension-logo">
        Rust Search Extension
    </div>
</a>

<nav>
    
    <a class="nav-item subtitle-text" href="&#x2F;how-it-works&#x2F;">How it works</a>
    
    <a class="nav-item subtitle-text" href="&#x2F;faq&#x2F;">FAQ</a>
    
    <a class="nav-item subtitle-text" href="&#x2F;changelog&#x2F;">Changelog</a>
    
    <a class="nav-item subtitle-text" href="&#x2F;privacy&#x2F;">Privacy</a>
    
    <a class="nav-item subtitle-text" href="https://github.com/huhu/rust-search-extension">Github</a>
</nav>

</header>


<main>
    
    <div class="toc">
        <div class="toc-sticky">
        
            
        
        
            
            <div class="toc-item">
                <a class="subtext" href="/how-it-works/#search-std-docs">Search std docs</a>
            </div>
                
                
                <div class="toc-item-child">
                    <a class="subtext" href="/how-it-works/#1-build-search-index"><small>- 1. Build search index</small></a>
                </div>
                
                <div class="toc-item-child">
                    <a class="subtext" href="/how-it-works/#2-build-search-words-array-based-on-search-index"><small>- 2. Build search words array based on search index</small></a>
                </div>
                
                <div class="toc-item-child">
                    <a class="subtext" href="/how-it-works/#3-search-keyword-in-search-words-array"><small>- 3. Search keyword in search words array</small></a>
                </div>
                
                <div class="toc-item-child">
                    <a class="subtext" href="/how-it-works/#4-sort-search-result"><small>- 4. Sort search result</small></a>
                </div>
                
                <div class="toc-item-child">
                    <a class="subtext" href="/how-it-works/#5-transform-search-result-to-suggestion-result-to-show-in-the-address-bar"><small>- 5. Transform search result to suggestion result to show in the address bar</small></a>
                </div>
                
            
        
            <div class="toc-item">
                <a class="subtext" href="/how-it-works/#search-crates-on-crates-io">Search crates on crates.io</a>
            </div>
                
                
                <div class="toc-item-child">
                    <a class="subtext" href="/how-it-works/#1-build-crates-index"><small>- 1. Build crates index</small></a>
                </div>
                
            
        
        
        </div>
    </div>
    

    <div class="content text">
        
<div class="heading-text">How it works</div>
<h1 id="search-std-docs">Search std docs</h1>
<h2 id="1-build-search-index">1. Build <em>search index</em></h2>
<p>The raw <em>search index</em> was generated by <strong>rustc-doc</strong>. The most important function is <code>build_index()</code> which 
located at <a href="https://github.com/rust-lang/rust/blob/master/src/librustdoc/html/render/cache.rs">librustdoc/html/render/cache.rs</a>.</p>
<p>The final <em>search index</em> is an object array like this:</p>
<pre style="background-color:#ffffff;">
<span style="font-weight:bold;color:#a71d5d;">var </span><span style="color:#323232;">searchIndex </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#323232;">[
    {
      crate: </span><span style="color:#183691;">&quot;std&quot;</span><span style="color:#323232;">,
      desc: </span><span style="color:#183691;">&quot;A hash map implemented with linear probing and Robin Hood bucket stealing.&quot;</span><span style="color:#323232;">,
      name: </span><span style="color:#183691;">&quot;HashMap&quot;</span><span style="color:#323232;">,
      parent: </span><span style="color:#0086b3;">undefined</span><span style="color:#323232;">,
      path: </span><span style="color:#183691;">&quot;std::collections&quot;</span><span style="color:#323232;">,
      ty: </span><span style="color:#0086b3;">3</span><span style="color:#323232;">,
      type: </span><span style="color:#0086b3;">null
    </span><span style="color:#323232;">},
    {
      crate: </span><span style="color:#183691;">&quot;std&quot;</span><span style="color:#323232;">,
      desc: </span><span style="color:#183691;">&quot;Applies function to the elements of iterator and returns the first non-none result.&quot;</span><span style="color:#323232;">,
      name: </span><span style="color:#183691;">&quot;find_map&quot;</span><span style="color:#323232;">,
      parent: {ty: </span><span style="color:#0086b3;">8</span><span style="color:#323232;">, name: </span><span style="color:#183691;">&quot;Iterator&quot;</span><span style="color:#323232;">},
      path: </span><span style="color:#183691;">&quot;std::iter&quot;</span><span style="color:#323232;">,
      ty: </span><span style="color:#0086b3;">11</span><span style="color:#323232;">,
      type: [[</span><span style="color:#183691;">&quot;self&quot;</span><span style="color:#323232;">],[</span><span style="color:#183691;">&quot;f&quot;</span><span style="color:#323232;">]]
    },
    </span><span style="font-weight:bold;color:#a71d5d;">...
</span><span style="color:#323232;">];
</span></pre><h2 id="2-build-search-words-array-based-on-search-index">2. Build <em>search words array</em> based on <em>search index</em></h2>
<p>The <em>search words array</em> is the list of search words to query against which build from the raw <em>search index</em>.
It's just a plain name array of every Rust structs, traits, enums, functions, methods, macros, etc.</p>
<pre style="background-color:#ffffff;">
<span style="font-weight:bold;color:#a71d5d;">var </span><span style="color:#323232;">searchWords </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#323232;">[
    </span><span style="color:#183691;">&quot;result&quot;</span><span style="color:#323232;">, 
    </span><span style="color:#183691;">&quot;option&quot;</span><span style="color:#323232;">, 
    </span><span style="color:#183691;">&quot;hashmap&quot;</span><span style="color:#323232;">, 
    </span><span style="color:#183691;">&quot;hashset&quot;</span><span style="color:#323232;">, 
    </span><span style="color:#183691;">&quot;clone&quot;</span><span style="color:#323232;">, 
    </span><span style="color:#183691;">&quot;copy&quot;</span><span style="color:#323232;">, 
    </span><span style="color:#183691;">&quot;display&quot;</span><span style="color:#323232;">, 
    </span><span style="color:#183691;">&quot;debug&quot;</span><span style="color:#323232;">,
    </span><span style="font-weight:bold;color:#a71d5d;">...
</span><span style="color:#323232;">];
</span></pre><h2 id="3-search-keyword-in-search-words-array">3. Search keyword in <em>search words array</em></h2>
<p>Using <em>Levenshtein distance</em> algorithm to search matched words, the max Levenshtein distance is 2.</p>
<pre style="background-color:#ffffff;">
<span style="font-style:italic;color:#969896;">// Max levenshtein distance.
</span><span style="font-weight:bold;color:#a71d5d;">var </span><span style="color:#0086b3;">MAX_LEV_DISTANCE </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#0086b3;">2</span><span style="color:#323232;">;
</span></pre><h2 id="4-sort-search-result">4. Sort <em>search result</em></h2>
<p>Sort search result according to <em>Levenshtein distance</em>, lexicographical and others metrics.</p>
<h2 id="5-transform-search-result-to-suggestion-result-to-show-in-the-address-bar">5. Transform <em>search result</em> to <em>suggestion result</em> to show in the address bar</h2>
<p>Mapping the <em>search word</em> and <em>search index</em> to generate the <em>search result</em>, build Rust doc link for each result item.</p>
<pre style="background-color:#ffffff;">
<span style="font-weight:bold;color:#a71d5d;">var </span><span style="color:#323232;">suggestResults </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#323232;">[
    {
      content: </span><span style="color:#183691;">&quot;https://doc.rust-lang.org/std/ops/trait.Deref.html&quot;</span><span style="color:#323232;">,
      description: </span><span style="color:#183691;">&quot;std::ops::&lt;match&gt;Deref&lt;/match&gt; - &lt;dim&gt;Used for immutable dereferencing operations, like `*v`.&lt;/dim&gt;&quot;
    </span><span style="color:#323232;">},
    {
      content: </span><span style="color:#183691;">&quot;https://doc.rust-lang.org/std/ops/trait.Deref.html#tymethod.deref&quot;</span><span style="color:#323232;">,
      description: </span><span style="color:#183691;">&quot;std::ops::Deref::&lt;match&gt;deref&lt;/match&gt; - &lt;dim&gt;Dereferences the value.&lt;/dim&gt;&quot;
    </span><span style="color:#323232;">},
    </span><span style="font-weight:bold;color:#a71d5d;">...
</span><span style="color:#323232;">];
</span></pre><h1 id="search-crates-on-crates-io">Search crates on crates.io</h1>
<h2 id="1-build-crates-index">1. Build crates index</h2>
<p>To be done...</p>


    </div>

</main>

<footer>
    <small class="subtext">
        <a href="https://huhu.io">Huhu.io</a> Â© 2020
    </small>
</footer>
</body>
</html>